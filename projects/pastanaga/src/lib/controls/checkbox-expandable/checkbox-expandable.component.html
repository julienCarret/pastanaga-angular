<div class="o-field-group">
    <pa-button color="secondary" size="small" icon="right-key"
               [ariaControls]="expandButtonId"
               [ariaExpanded]="!isCollapsed"
               (click)="toggleCollapsedState()">{{isCollapsed ? 'common.expand' : 'common.collapse'}}
    </pa-button>

    <pa-checkbox *ngIf="!control.isFiltered"
                 [type]="type"
                 [(id)]="control.id"
                 [icon]="control.icon"
                 [help]="control.help"
                 [(isSelected)]="control.isSelected"
                 [isDisabled]="control.isDisabled"
                 [isIndeterminate]="control.isIndeterminate"
                 (selection)="updateControlSelection()">{{control.label}}
    </pa-checkbox>

    <div class="o-field-sublist" role="tabpanel" [id]="expandButtonId" [attr.aria-labelledby]="expandButtonId"
         [attr.aria-hidden]="isCollapsed" [@toggleHeight]="collapsedState">
        <fieldset class="o-fieldset-group" [id]="fieldsetGroupId" [hidden]="isHidden">
            <legend *ngIf="sublistLegend" class="o-sr" translate>{{sublistLegend}}</legend>

            <ng-container *ngFor="let checkbox of control.children">
                <pa-checkbox *ngIf="!checkbox.isFiltered"
                             [type]="type"
                             [(id)]="checkbox.id"
                             [icon]="checkbox.icon"
                             [help]="checkbox.help"
                             [(isSelected)]="checkbox.isSelected"
                             [isDisabled]="checkbox.isDisabled || control.isDisabled"
                             (selection)="updateChildSelection()">{{checkbox.label}}
                </pa-checkbox>
            </ng-container>
        </fieldset>
    </div>
</div>
