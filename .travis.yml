language: node_js
node_js:
- 10.15.0
cache:
  directories:
    - node_modules
dist: trusty
install:
  - npm install
script:
  - npm test
  - npm build
notifications:
  email:
  - ebrehault@gmail.com
before_deploy:
  - export PACKAGE_VERSION=$(npm run get_version | tail -n 1)
  - git tag $PACKAGE_VERSION
deploy:
  on:
    tags: true